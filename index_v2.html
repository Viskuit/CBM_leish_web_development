<!DOCTYPE html>
<html>
<head>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" rel="stylesheet" type="text/css">
    <link href="./styles/index.css" rel="stylesheet" type="text/css">
    <title>Leish-NEW</title>
</head>
<body>
    <header>
        <ul>
            <li></li><h1>LEISH-NEW</h1></li>
            <li><h2>Leishmania genome decoding</h2></li>
        </ul>
    </header>

    <div class="top-menu">
        <div class="search-bar">
            <input type="text" placeholder="Search..">
            <button type="submit">Search</button>
        </div>
        <nav>
            <div class="dropdown">
                <a href="#">About Us</a>
                <div class="dropdown-content">
                    <a href="#">Our Mission</a>
                    <a href="#">Our Team</a>
                    <a href="#">Contact</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="#">Species</a>
                <div class="dropdown-content">
                    <a href="#">Mammals</a>
                    <a href="#">Birds</a>
                    <a href="#">Reptiles</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="#">Downloads</a>
                <div class="dropdown-content">
                    <a href="#">Reports</a>
                    <a href="#">Datasets</a>
                    <a href="#">Software</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="#">Extra</a>
                <div class="dropdown-content">
                    <a href="#">Blog</a>
                    <a href="#">News</a>
                    <a href="#">Events</a>
                </div>
            </div>
        </nav>
    </div>
    
    <div class="reddit-like">
        <aside class="left-column">
            <h2>Filters</h2>
            <div class="filters">
                <ul>
                    <li>
                        <input type="checkbox" id="filter-major" class="opt-in" value="L. major">
                        <label for="filter-major"><i>L. major</i></label>
                    </li>
                    <li>
                        <input type="checkbox" id="filter-infantum" class="opt-in" value="L. infantum">
                        <label for="filter-infantum"><i>L. infantum</i></label>
                    </li>
                    <li>
                        <input type="checkbox" id="filter-donovani" class="opt-in" value="L. donovani">
                        <label for="filter-donovani"><i>L. donovani</i></label>
                    </li>
                    <li>
                        <input type="checkbox" id="filter-braziliensis" class="opt-in" value="L. braziliensis">
                        <label for="filter-braziliensis"><i>L. braziliensis</i></label>
                    </li>
                </ul>
            </div>
        </aside>

        <main class="center-column" id="posts-container">
            <!-- Dynamic posts will be inserted here by JavaScript -->
        </main>

        <aside class="right-column">
            <div id="calendar-container">
                <h3>Calendar</h3>
                <div id="calendar"></div>
            </div>
            
            <!-- Twitter Widget -->
            <div id="twitter-widget-container">
                <a class="twitter-timeline" data-height="600" href="https://twitter.com/who?ref_src=twsrc%5Etfw">Tweets by WHO</a>
            </div>
        </aside>
    </div>

    <footer>
        <p>SOMTHING WRITE IN FOOTER</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script>
    <script src="./scripts/calendar.js"></script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <script>
        // Force reload Twitter widgets
        window.twttr = (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0],
                t = window.twttr || {};
            if (d.getElementById(id)) return t;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js, fjs);

            t._e = [];
            t.ready = function(f) {
                t._e.push(f);
            };

            return t;
        }(document, "script", "twitter-wjs"));

        twttr.ready(function (twttr) {
            twttr.widgets.load();
        });

        document.addEventListener("DOMContentLoaded", function() {
    const postsContainer = document.getElementById('posts-container');

    fetch('./data/posts.json')
        .then(response => response.json())
        .then(posts => {
            posts.forEach(post => {
                const postDiv = document.createElement('div');
                postDiv.classList.add('post');
                postDiv.setAttribute('data-tags', post.tags.join(','));

                const postTitle = document.createElement('h3');
                postTitle.textContent = post.title;

                const postDescription = document.createElement('p');
                postDescription.textContent = post.description;

                const postTags = document.createElement('p');
                postTags.textContent = 'Tags: ' + post.tags.join(', ');

                postDiv.appendChild(postTitle);
                postDiv.appendChild(postDescription);
                postDiv.appendChild(postTags);

                postsContainer.appendChild(postDiv);
            });

            // Add event listeners for filtering
            const checkboxes = document.querySelectorAll('.filters .opt-in');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    const selectedTags = Array.from(checkboxes)
                        .filter(checkbox => checkbox.checked)
                        .map(checkbox => checkbox.value);

                    console.log('Selected tags:', selectedTags);  // Debugging output
                    filterPosts(selectedTags);
                });
            });

            function filterPosts(selectedTags) {
                const postsElements = document.querySelectorAll('.post');

                postsElements.forEach(post => {
                    const postTags = post.getAttribute('data-tags').split(',');
                    console.log('Post tags:', postTags);  // Debugging output

                    if (selectedTags.length === 0 || selectedTags.some(tag => postTags.includes(tag))) {
                        post.style.display = 'block';
                        console.log('Displaying post with tags:', postTags);  // Debugging output
                    } else {
                        post.style.display = 'none';
                        console.log('Hiding post with tags:', postTags);  // Debugging output
                    }
                });
            }
        })
        .catch(error => console.error('Error loading posts:', error));
});
    </script>
</body>
</html>
