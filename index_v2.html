<!DOCTYPE html>
<html>
<head>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css" rel="stylesheet" type="text/css">
    <link href="./styles/index.css" rel="stylesheet" type="text/css">
    <title>Leish-ESP</title>
</head>
<body>
    <header>
        <ul>
            <li></li><h1>LEISH-ESP</h1></li>
            <li><h2>Leishmania genome decoding</h2></li>
        </ul>
    </header>

    <div class="top-menu">
        <div class="search-bar">
            <input type="text" placeholder="Search..">
            <button type="submit">Search</button>
        </div>
        <nav>
            <div class="dropdown">
                <a href="#">About Us</a>
                <div class="dropdown-content">
                    <a href="#">Our Mission</a>
                    <a href="#">Our Team</a>
                    <a href="#">Contact</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="#">Species</a>
                <div class="dropdown-content">
                    <a href="#">Mammals</a>
                    <a href="#">Birds</a>
                    <a href="#">Reptiles</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="#">Downloads</a>
                <div class="dropdown-content">
                    <a href="#">Reports</a>
                    <a href="#">Datasets</a>
                    <a href="#">Software</a>
                </div>
            </div>
            <div class="dropdown">
                <a href="#">Extra</a>
                <div class="dropdown-content">
                    <a href="#">Blog</a>
                    <a href="#">News</a>
                    <a href="#">Events</a>
                </div>
            </div>
        </nav>
    </div>
    
    <div class="reddit-like">
        <aside class="left-column">
            <h2>Filters</h2>
            <div id="filters">
                <ul>
                    <li><button class="filter-btn" data-filter="all">Show All</button></li>
                    <li><button class="filter-btn" data-filter="fire">Fire</button></li>
                    <li><button class="filter-btn" data-filter="earth">Earth</button></li>
                    <li><button class="filter-btn" data-filter="water">Water</button></li>
                    <li><button class="filter-btn" data-filter="air">Air</button></li>
                </ul>
            </div>
        </aside>

        <main class="center-column" id="posts-container">
            <!-- Dynamic posts will be inserted here by JavaScript -->
        </main>

        <aside class="right-column">
            <div id="calendar-container">
                <h3>Calendar</h3>
                <div id="calendar"></div>
            </div>
            
            <!-- Twitter Widget -->
            <div id="twitter-widget-container">
                <h3>Twitter</h3>
                <a class="twitter-timeline" data-height="400" href="https://twitter.com/poke_tiempo?ref_src=twsrc%5Etfw">Tweets by Poke tiempo</a>
            </div>
        </aside>
    </div>

    <footer>
        <p>SOMTHING WRITE IN FOOTER</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js"></script>
    <script src="./scripts/calendar.js"></script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <script>
        // Force reload Twitter widgets
        window.twttr = (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0],
                t = window.twttr || {};
            if (d.getElementById(id)) return t;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js, fjs);

            t._e = [];
            t.ready = function(f) {
                t._e.push(f);
            };

            return t;
        }(document, "script", "twitter-wjs"));

        twttr.ready(function (twttr) {
            twttr.widgets.load();
        });

        // Fetch posts from JSON and display them
        document.addEventListener("DOMContentLoaded", function() {
            const postsContainer = document.getElementById('posts-container');

            fetch('./data/posts.json')
                .then(response => response.json())
                .then(posts => {
                    posts.forEach(post => {
                        const postDiv = document.createElement('div');
                        postDiv.classList.add('post');
                        // Use the tags from the post
                        postDiv.setAttribute('data-tags', post.tags.join(' '));

                        const postTitle = document.createElement('h3');
                        postTitle.textContent = post.title;

                        const postDescription = document.createElement('p');
                        postDescription.textContent = post.description;

                        const postTags = document.createElement('p');
                        postTags.textContent = 'Tags: ' + post.tags.join(', ');

                        postDiv.appendChild(postTitle);
                        postDiv.appendChild(postDescription);
                        postDiv.appendChild(postTags);

                        postsContainer.appendChild(postDiv);
                    });

                    // Add event listeners for filtering
                    const filterButtons = document.querySelectorAll('.filter-btn');
                    const postsElements = document.querySelectorAll('.post');

                    filterButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            const filter = button.getAttribute('data-filter');
                            if (filter === 'all') {
                                postsElements.forEach(post => {
                                    post.style.display = 'block';
                                });
                            } else {
                                postsElements.forEach(post => {
                                    const tags = post.getAttribute('data-tags').split(' ');
                                    if (tags.includes(filter)) {
                                        post.style.display = 'block';
                                    } else {
                                        post.style.display = 'none';
                                    }
                                });
                            }
                        });
                    });
                })
                .catch(error => console.error('Error loading posts:', error));
        });
    </script>
</body>
</html>
